<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>CreateChartusingSVG</title>
	 <style type="text/css">
.lines:hover{
			filter:url(#f2);
}
.lines{


}
	.text1:hover{
		{style:"bold";}
	.text1{
	filter:url(#f4);
	}

	   #chartcontainer 

       {  filter:drop-shadow(8px 8px 10px gray);filter:blur(24);}
	   #chartcontainer:hover 

       {  filter:blur(24);}


       #charttype 
      { border: double; }
	  #charttype:hover{ filter:drop-shadow(8px 8px 10px gray);
	  
	  }

//    
 //   <style type="text/css">
 //       #chartcontainer 
 //       { height: 550px; width: 600px; border: double; background-color:aliceblue; position: fixed; top:100px; left: 500px; }

//        #charttype 
 //       { border: double; height: 75px; width: 100px; position: fixed; left:750px; }

    </style>

    <script type="text/javascript">
        var studentexamdata = new Array(100);


        studentexamdata[0] = "01,80";
        studentexamdata[1] = "02,40";
        studentexamdata[2] = "03,70";
        studentexamdata[3] = "04,80";
        studentexamdata[4] = "05,30";
        studentexamdata[5] = "06,90";
        studentexamdata[6] = "07,70";
        studentexamdata[7] = "08,80";
        studentexamdata[8] = "09,100";
        studentexamdata[9] = "10,60";
		var i=10;
		for ( i=10;i<100;i++){
			studentexamdata[i] = i+","+Math.floor((Math.random() * 100) + 1);;
			}
		var old_x1=parseInt(studentexamdata[0].split(",")[0]);old_y1=parseInt(studentexamdata[0].split(",")[01]);initial=0;
		console.log(old_x1);console.log(old_y1);
        var svg;
        var svgWidth, svgHeight, svgMargin, svgSpace;
        var MarginSpace, MarginHeight;
        var barchartWidth, barchartMargin, totalChartBars, maximumDataValue;
        var LabelOnYAxis,LabelOnYAxis ;

        function drawBarChart()
        {
            svg = document.getElementsByTagName('svg')[0];

            var barchart = document.getElementById('barchart');
            barchart.addEventListener('click', function ()
            {
                clear();
                ChartSettings();
                drawAxis();
                drawChart("Bar");
            }, false);

            var pointchart = document.getElementById('pointchart');
            pointchart.addEventListener('click', function ()
            {
                clear();
                ChartSettings();
                drawAxis();
                drawChart("Point");
            }, false);
			var pointchart = document.getElementById('linechart');
            pointchart.addEventListener('click', function ()
            {
                clear();
                ChartSettings();
                drawAxis();
                drawChart("Line");
            }, false);
			var polychart = document.getElementById('polychart');
            polychart.addEventListener('click', function ()
            {
                clear();
                ChartSettings();
                drawAxis();
                drawChart("Poly");
            }, false);

        }

        function clear()
        {
            while (svg.lastChild)
            {
                svg.removeChild(svg.lastChild);
            }
        }

        function ChartSettings()
        {
            svgMargin = 20;
            svgSpace = 60;

            svgHeight = svg.height.baseVal.value - 2 * svgMargin - svgSpace;
            svgWidth = svg.width.baseVal.value - 2 * svgMargin - svgSpace;

            MarginSpace = svgMargin + svgSpace;
            MarginHeight = svgMargin + svgHeight;
            MarginWidth = svgMargin + svgWidth;

            barchartMargin = 15;
//            totalChartBars = studentexamdata.length;
            totalChartBars = 15;
            barchartWidth = (svgWidth / totalChartBars) - barchartMargin;

            maximumDataValue = 0;
            for (var i = 0; i < totalChartBars; i++)
            {
                var arrVal = studentexamdata[i].split(",");
                var barVal = parseInt(arrVal[1]);
                if (parseInt(barVal) > parseInt(maximumDataValue))
                    maximumDataValue = barVal;
            }
			maximumXValue = 0;
            for (var i = 0; i < totalChartBars; i++)
            {
                var arrVal = studentexamdata[i].split(",");
                var barVal = parseInt(arrVal[0]);
                if (parseInt(barVal) > parseInt(maximumXValue))
                    maximumXValue = barVal;
            }


            LabelOnYAxis = 10;
			LabelOnXAxis = 10;
        }

        function drawAxis()
        {
            //Y-Axis
            drawXYAxis(MarginSpace, MarginHeight, MarginSpace, svgMargin);
            //X-Axis
            drawXYAxis(MarginSpace, MarginHeight, MarginSpace + MarginWidth, MarginHeight);
            drawMarkers();
        }

        function drawXYAxis(x1, y1, x2, y2)
        {
            var newdataAxis = document.createElementNS("http://www.w3.org/2000/svg", 'line');
            newdataAxis.setAttribute("x1", x1);
            newdataAxis.setAttribute("y1", y1);
            newdataAxis.setAttribute("x2", x2);
            newdataAxis.setAttribute("y2", y2);
            newdataAxis.style.stroke = "black";
            newdataAxis.style.strokeWidth = "5px";
            svg.appendChild(newdataAxis);
        }

        function drawMarkers()
        {
            var numberMarkers = parseInt(maximumDataValue / LabelOnYAxis);
            for (var i = 0; i < LabelOnYAxis + 1; i++)
            {
                markerVal = i * numberMarkers;
                markerValHt = i * numberMarkers * svgHeight;
                var xaxisMarkers = MarginSpace - 5;
                var yaxisMarkers = MarginHeight - (markerValHt / maximumDataValue);
                textelement = document.createElementNS("http://www.w3.org/2000/svg", 'text');
                textelement.setAttribute('dx', xaxisMarkers-40);
                textelement.setAttribute('dy',yaxisMarkers);
				textelement.setAttribute('class',"text1");

                txtnode = document.createTextNode(markerVal);
                textelement.appendChild(txtnode);
                svg.appendChild(textelement);
            }
            for (var i = 0; i < totalChartBars; i++)
            {
				currVal=i*studentexamdata.length/totalChartBars;
				currVal=currVal.toFixed(0);
                arrVal = studentexamdata[currVal].split(",");
                name = arrVal[0];
                markerXPosition = MarginSpace + barchartMargin + (i * (barchartWidth + barchartMargin)) + (barchartWidth / 2);
                markerYPosition = MarginHeight + 20;
                textelement = document.createElementNS("http://www.w3.org/2000/svg", 'text');
                textelement.setAttribute('dx', markerXPosition);
                textelement.setAttribute('dy', markerYPosition);
				textelement.setAttribute('class',"text1");
                txtnode = document.createTextNode(name);
                textelement.appendChild(txtnode);
                svg.appendChild(textelement);
            }
        }

        function drawRectangleForChart(x, y, wd, ht, fill) {
            var rect = document.createElementNS("http://www.w3.org/2000/svg", 'rect');
            rect.setAttributeNS(null, 'x', x);
            rect.setAttributeNS(null, 'y', y);
            rect.setAttributeNS(null, 'width', wd);
            rect.setAttributeNS(null, 'height', ht);
            rect.setAttributeNS(null, 'fill', "yellow");
            rect.setAttributeNS(null, 'fill-opacity', "0.05");
            rect.setAttributeNS(null, 'stroke', "green");
            rect.setAttributeNS(null, 'stroke-opacity', "0.9");
            rect.setAttributeNS(null, 'stroke-width', "5");
			rect.setAttributeNS(null, 'class', 'lines');
			

            svg.appendChild(rect);
        }

        function drawEllipse(x, y, rx) {
            var circle = document.createElementNS("http://www.w3.org/2000/svg", 'circle');
            circle.setAttributeNS(null, 'cx', x);
            circle.setAttributeNS(null, 'cy', y);
            circle.setAttributeNS(null, 'r', rx);
            circle.setAttributeNS(null, 'fill', "darkred");
			circle.setAttributeNS(null, 'class', 'lines');
            svg.appendChild(circle);
        }
        function drawLine(x, y, rx) {
            var line = document.createElementNS("http://www.w3.org/2000/svg", 'line');
            line.setAttributeNS(null, 'x1', old_x1)
			line.setAttributeNS(null, 'y1',old_y1);
            line.setAttributeNS(null, 'x2', x)
			line.setAttributeNS(null, 'y2',y);
			
			old_x1=x;old_y1=y;
            line.setAttributeNS(null, 'stroke-width', rx);
            line.setAttributeNS(null, 'fill', "darkred");
            line.setAttributeNS(null, 'stroke', "black");
            line.setAttributeNS(null, 'stroke-width', rx);
			line.setAttributeNS(null, 'class', 'lines');
            svg.appendChild(line);

        }
		
        function drawPoly(points, rx) {


    
            var polyline = document.createElementNS("http://www.w3.org/2000/svg", 'polyline');
			
			console.log(points);

            polyline.setAttributeNS(null, 'points', points)
			
            polyline.setAttributeNS(null, 'stroke-width', rx);
            polyline.setAttributeNS(null, 'fill', "blue");
            polyline.setAttributeNS(null, 'fill-opacity', "0.05");
			
            polyline.setAttributeNS(null, 'stroke', "black");
			polyline.setAttributeNS(null, 'class', 'lines');
            svg.appendChild(polyline);
			drawChart("Point");
        }

        function drawChart(chart)
        {
			var points="";
			if(chart=="Poly"){
			var examdata=studentexamdata;
			for (var i = 0; i < totalChartBars; i++)
            {
                var arrchartVal = examdata[i].split(",");
                bcVal = parseInt(arrchartVal[1]);
                bcHt = (bcVal * svgHeight / maximumDataValue);
                bcX = MarginSpace + (i * (barchartWidth + barchartMargin)) + barchartMargin + 10;
                bcY = (MarginHeight - bcHt - 2);
				points+=bcX+','+bcY+' ';


			
			}
			var x1=MarginSpace + (0 * (barchartWidth + barchartMargin)) + barchartMargin + 10;
			var x2=MarginSpace + (totalChartBars * (barchartWidth + barchartMargin)) + barchartMargin + 10;
			points=x1+","+svgHeight+" "+points+" "+x2+","+svgHeight;
			console.log(points);
			drawPoly(points, 5,5);
			return;
			console.log("did not return");
			}
			
			
            for (var i = 0; i < totalChartBars; i++)
            {
                var arrchartVal = studentexamdata[i].split(",");
                bcVal = parseInt(arrchartVal[1]);
                bcHt = (bcVal * svgHeight / maximumDataValue);
                bcX = MarginSpace + (i * (barchartWidth + barchartMargin)) + barchartMargin + 10;
                bcY = (MarginHeight - bcHt - 2);
				points+=bcX+','+bcY+' ';
				console.log(points);
				if(initial++==0){old_x1=bcX;old_y1=bcY;}
                switch (chart)
                {
                    case "Bar":
                        drawRectangleForChart(bcX, bcY, barchartWidth, bcHt, true);
                        break;

                    case "Point":
                        drawEllipse(bcX, bcY, 5, 5);
                        break;
                    case "Line":
                        drawLine(bcX, bcY, 5, 5);
                        drawEllipse(bcX, bcY, 5, 5);

                        break;
                    case "Poly":
                        drawPoly(points, 5,5);
                        break;

                }

            }
		old_x1=parseInt(studentexamdata[0].split(",")[0]);old_y1=parseInt(studentexamdata[0].split(",")[01]);
		}
		function filters(){
		
		var svg=document.getElementById("lines");
var fs=document.getElementById("lines");
var circles=0;
var svgns="http://www.w3.org/2000/svg";
var w=window.innerWidth;

function createfilter(posx,posy,sizex,sizey,type,data){
    var filter=document.createElementNS(svgns,"lines");
    filter.setAttribute("id","f"+circles);
    //filter.setAttribute("x",posx);
    //filter.setAttribute("y",posy);
    //filter.setAttribute("width",sizex);
    //filter.setAttribute("height",sizey);
    fs.appendChild(filter);
    for(z=0;z<(data.length/2);z++){
        var filter=document.createElementNS(svgns,type[z]);
        filter.setAttributeNS(null,"in","SourceGraphic");
        filter.setAttributeNS(null,data[2*z],data[2*z+1]);
        document.getElementById("f"+circles).appendChild(filter);
    }
    console.log(document.getElementById("f"+circles)); //to see if it has worked or not
}

function createcircle(posx,posy,radius,stroke,fill,filter){
    var circle=document.createElementNS(svgns,"circle");
    circle.setAttributeNS(null,"id","c"+circles);
    circle.setAttributeNS(null,"cx",posx);
    circle.setAttributeNS(null,"cy",posy);
    circle.setAttributeNS(null,"r",radius);
    circle.setAttributeNS(null,"stroke-width",stroke);
    circle.setAttributeNS(null,"fill",fill);
    circle.setAttributeNS(null,"filter",filter);
    circle.setAttributeNS(null,"data-posx",posx);
    svg.appendChild(circle);
    console.log(circle);
}

for(i=0;i<10;i++){
    circles+=1;
    createcircle((i*w/10),"50%","100","0","hsla("+(i*36)+",100%,50%,0.5)","url(#f"+circles+")");        createfilter("-50%","-50%","200%","200%",["feGaussianBlur"],["stdDeviation","5"]);
//this works - the parameters are (posx,posy,radius,stroke,fill,filter) but currently I can only use a filter that I have created in the html svg element as my code doesn't work
}
		
		}
        window.onload = drawBarChart;
    </script>
</head>

<body>
    <div id="chartcontainer">
        <svg id="svgcontainer" height="600" width=window.innerWidth>
		 <defs>
    <filter id="f1" x="0" y="0">
      <feOffset in="SourceGraphic" stdDeviation="15" />
    </filter>
	<filter id="f3" x="0" y="0" width="200%" height="200%">
      <feOffset result="offOut" in="SourceAlpha" dx="20" dy="20" />
      <feGaussianBlur result="blurOut" in="offOut" stdDeviation="10" />
      <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />
    </filter>
    <filter id="f4" x="0" y="0" width="200%" height="200%">
      <feOffset result="offOut" in="SourceGraphic" dx="20" dy="20" />
      <feColorMatrix result="matrixOut" in="offOut" type="matrix"
      values="0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0" />
      <feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="10" />
      <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />
	 <radialGradient id="grad1" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
      <stop offset="0%" style="stop-color:rgb(255,255,255);
      stop-opacity:0" />
      <stop offset="100%" style="stop-color:rgb(0,0,255);stop-opacity:1" />
    </radialGradient>
    </filter>
    <filter id="f2" filterUnits="userSpaceOnUse" x="0" y="0" width="200" height="120">
      <feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur" />
      <feOffset in="blur" dx="4" dy="4" result="offsetBlur" />
      <feSpecularLighting in="blur" surfaceScale="5" specularConstant=".75" specularExponent="20" lighting-color="#bbbbbb" result="specOut">
        <fePointLight x="-5000" y="-10000" z="20000" />
      </feSpecularLighting>
    </filter>
	
  </defs>

  </defs>
  <rect x="15" y="15" width="50" height="60" stroke="green" stroke-width="3"
  style="fill:blue;stroke:pink;stroke-width:5;fill-opacity:0.05;stroke-opacity:0.9"  filter="url(#f4)" />

        </svg>
    </div>
    <div id="charttype">
        <br />
        <input type="radio"  id="barchart" name="Chart" />Bar Chart 
        <br />
        <input type="radio" id="pointchart" name="Chart" />Point Chart
        <br />
        <input type="radio" id="linechart" name="Chart" />Line Chart
        <br />
        <input type="radio" id="polychart" name="Chart" />Poly Line Chart
    </div>
</body>

</html>
